{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <a href="{% url 'order_list' %}" class="btn btn-secondary">üì¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</a>

    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <form method="post">
        {% csrf_token %}

        <label>–§–ò–û:</label>
        <input type="text" name="full_name" class="form-control mb-3" value="{{ profile.full_name }}" required>

	<label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
	<input type="text" name="phone" class="form-control mb-3" value="{{ profile.phone }}" 
               pattern="^(\+7|8)\d{10}$" 
	       title="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX" 
	       required
	       oninput="validatePhone(this)">

        <label>Email:</label>
        <input type="email" name="email" class="form-control mb-3" value="{{ user.email }}">

        <label>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
        <textarea name="address" class="form-control mb-3" required>{{ profile.address }}</textarea>

        <label>Telegram ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
        <input type="text" name="telegram_id" class="form-control mb-3" value="{{ profile.telegram_id }}">

        <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <p class="mt-3">
        ‚ùì –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ Telegram, –ø—Ä–∏–≤—è–∂–∏—Ç–µ —Å–≤–æ–π Id –∫ –ø—Ä–æ—Ñ–∏–ª—é. –î–ª—è —ç—Ç–æ–≥–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É <b>/start</b> –Ω–∞—à–µ–º—É <a href="https://t.me/flowershop_delivery_bot" target="_blank">–±–æ—Ç—É</a> –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <b>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä</b>.
    </p>
</div>
<script>
function validatePhone(input) {
    const phonePattern = /^\+7\d{10}$/;
    if (!phonePattern.test(input.value)) {
        input.setCustomValidity("–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX");
    } else {
        input.setCustomValidity("");
    }
}
</script>
{% endblock %}
